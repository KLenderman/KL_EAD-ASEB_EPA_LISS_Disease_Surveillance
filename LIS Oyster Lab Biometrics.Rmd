---
title: "LIS Oyster Lab Tissue Processing"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 


```{r, echo=FALSE}
library("dplyr")                                    
library("plyr")                                     
library("readr")             
library("Rmisc")
library("ggplot2")
library("lubridate")
```

```{r}
#Set Path
setwd("C:/Users/katherine.mcfarland/Documents/GitHub/EAD-ASEB_EPA_LISS_Disease_Surveillance/Lab_Data_TissueProcessing")
```

#Reading in google sheets from the good drive

```{r}
#Install the required package
#install.packages('googlesheets4')

library(googlesheets4)
```

```{r}
ASHC_0423 <- read_sheet("https://docs.google.com/spreadsheets/d/1FTIfau5DBKxqmWdYpQB--2qYXgYGwsqRw3Qxy7Zi7Wk/edit?usp=drive_link")
```

```{r}
head(ASHC_0423)
```

### This code chunk merges all .csv files within the Tissue processing folder into one data fram and outputs the full dataset into a .csv master file. This allows us to download the raw data as a .csv, add it to the repository folder, and create the master data file without copying and pasting data in excel.
# reading in .csv files from local folder
```{r}
data_all <- list.files(path = "C:/Users/katherine.mcfarland/Documents/GitHub/EAD-ASEB_EPA_LISS_Disease_Surveillance/Lab_Data_TissueProcessing/Files_by_Month",                           # Identify all CSV files
  pattern = "*.csv", full.names = TRUE) %>% 
  lapply(read_csv) %>%                              # Store all files in list
  bind_rows                                         # Combine data sets into one data set 
data_all                                            # Print data to RStudio console

as.data.frame(data_all)                            # Convert tibble to data.frame

write.csv(data_all, "C:/Users/katherine.mcfarland/Documents/GitHub/EAD-ASEB_EPA_LISS_Disease_Surveillance/Lab_Data_TissueProcessing\\All_tissue_processing_data.csv", row.names=FALSE)
 
```


## Need to figure out how to fix the date !!!!
 https://lubridate.tidyverse.org/
```{r}
str(data_all)

# convert date info in format 'mm/dd/yyyy'
data.frame$date <- ymd("2023-04-23")

str(data.frame)

```


# Summary of all data 
```{r}
st_height <- summarySE(data_all, measurevar="height_mm", groupvars=c("site", "date_collected"))
st_height 

#Calculate completeness for QC
st_height$Completeness <- st_height$N /30

st_height

write.csv(st_height, "C:/Users/katherine.mcfarland/Documents/GitHub/EAD-ASEB_EPA_LISS_Disease_Surveillance/Lab_Data_TissueProcessing\\Completeness_tissue_processing_data.csv", row.names=FALSE)
```
```{r}
ggplot(data=data_all, aes(x=site, y=height_mm, fill=site)) +
  geom_boxplot()+  #scale_fill_manual(values=c("forestgreen","orange", "purple"))+
  theme_bw() +  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+ 
  #theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
  labs(title="Mean Shell Height ", x ="site", y = "Mean Shell Height (mm)")
```


# Ash Creek Summary
```{r}
df_ASHC<- data_all%>%
  filter(site=="ASHC")

st_height_ASHC <- summarySE(df_ASHC, measurevar="height_mm", groupvars=c("date_collected"))
st_height_ASHC
```


```{r}
ggplot(data=df_ASHC, aes(x=date_collected, y=height_mm, fill=site)) +
  geom_boxplot()+  #scale_fill_manual(values=c("forestgreen","orange", "purple"))+
  theme_bw() +  theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank())+ 
  #theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
  labs(title="Mean Shell Height ", x ="date collected", y = "Mean Shell Height (mm)")
```
# Fence Creek Summary
```{r}
df_FENC<- data_all%>%
  filter(site=="FENC")


st_height_FENC <- summarySE(df_FENC, measurevar="height_mm", groupvars=c("date_collected"))
st_height_FENC 

```

# Laurel Hollow Summary
```{r}
df_LAUR<- data_all%>%
  filter(site=="LAUR")


st_height_LAUR <- summarySE(df_LAUR, measurevar="height_mm", groupvars=c("date_collected"))
st_height_LAUR 

```

# Gold Star Beach Summary
```{r}
df_GOLD<- data_all%>%
  filter(site=="GOLD")


st_height_GOLD <- summarySE(df_GOLD, measurevar="height_mm", groupvars=c("date_collected"))
st_height_GOLD 

```

```{r}
sessionInfo()
```


Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Ctrl+Alt+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Ctrl+Shift+K* to preview the HTML file).

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.
